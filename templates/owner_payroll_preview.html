{% extends 'base.html' %}
{% block content %}
<h2>Payroll Preview</h2>
<div class="text-muted" style="font-size:0.95rem; margin-top:-0.25rem; margin-bottom:1rem;">Review the payroll before submitting.</div>

<form method="post" action="/owner/payroll">
  <input type="hidden" name="period_start" value="{{ preview.period_start }}">
  <input type="hidden" name="period_end" value="{{ preview.period_end }}">
  <input type="hidden" name="pay_date" value="{{ preview.pay_date }}">

  <div class="table-responsive">
    <table class="table table-sm align-middle mb-0">
      <thead>
        <tr>
          <th>Employee</th>
          <th>Regular Pay (hrs)</th>
          <th>Vacation Pay</th>
          <th>Total Hrs</th>
          <th>Gross Pay</th>
        </tr>
      </thead>
      <tbody>
        {% for row in preview.rows %}
          <tr>
            <td>{{ (row.employee.first_name ~ ' ' ~ row.employee.last_name).strip() }}</td>
            <td>{{ '%.2f'|format(row.hours or 0) }}</td>
            <td>{% if row.vacation_enabled %}4%{% else %}-{% endif %}</td>
            <td>{{ '%.2f'|format(row.hours or 0) }}</td>
            <td>{{ row.gross | money }}</td>
          </tr>
          <input type="hidden" name="include_{{ row.employee.id }}" value="on">
          <input type="hidden" name="hours_{{ row.employee.id }}" value="{{ row.hours }}">
        {% endfor %}
        <tr class="fw-semibold">
          <td>Total</td>
          <td>{{ '%.2f'|format(preview.totals.regular_hours or 0) }}</td>
          <td></td>
          <td>{{ '%.2f'|format(preview.totals.total_hours or 0) }}</td>
          <td>{{ preview.totals.gross | money }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="mt-3 d-flex gap-2">
    <button class="btn btn-primary btn-sm">Submit Payroll</button>
    <a class="btn btn-outline-secondary btn-sm" href="/owner/payroll">Back</a>
  </div>
</form>
{% endblock %}
