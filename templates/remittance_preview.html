{% extends 'base.html' %}
{% block content %}
<h2>Remittance Voucher Preview</h2>
<div class="d-flex gap-2 flex-wrap mb-3">
  {% if print_url %}
    <a class="btn btn-secondary btn-sm" href="{{ print_url }}" target="_blank" rel="noopener">Print</a>
  {% else %}
    <button class="btn btn-secondary btn-sm" type="button" onclick="window.print()">Print</button>
  {% endif %}
  {% if download_url %}
    <a class="btn btn-primary btn-sm" href="{{ download_url }}" target="_blank" rel="noopener">Download</a>
  {% endif %}
</div>

<style>
  .voucher {
    border: 1px solid #bbb;
    padding: 14px;
    background: #fff;
    font-family: "Times New Roman", Times, serif;
  }
  .voucher .small {
    font-size: 16px;
  }
  .voucher .box {
    border: 2px solid #000;
    padding: 4px 6px;
    min-height: 30px;
  }
  .voucher .box-title {
    font-size: 14px;
    font-weight: 700;
    margin-bottom: 4px;
  }
  .voucher .value {
    font-size: 16px;
    font-weight: 700;
  }
  .voucher .amount {
    font-size: 18px;
    font-weight: 700;
    text-align: right;
    white-space: nowrap;
  }
  .voucher .line {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    gap: 10px;
  }
  .voucher .line .label {
    font-size: 14px;
    font-weight: 700;
    white-space: nowrap;
  }
  .voucher .line .val {
    font-size: 18px;
    font-weight: 700;
    white-space: nowrap;
  }
  .voucher .account-line {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    gap: 12px;
    flex-wrap: nowrap;
  }
  .voucher .account-line .acct {
    font-size: 16px;
    font-weight: 700;
    white-space: nowrap;
  }
  .voucher .header-strong {
    font-size: 16px;
    font-weight: 700;
  }
  .voucher .company-strong {
    font-size: 16px;
    font-weight: 700;
  }
  @media print {
    .btn { display: none !important; }
    header, footer { display: none !important; }
    .nav-card, .container > .d-flex { display: none !important; }
    .col-12.col-md-3 { display: none !important; }
    .container { max-width: none !important; }
    .voucher { border: none; }
  }
</style>

{% if auto_print %}
<script>
  window.addEventListener('load', function(){
    try { window.print(); } catch(e) {}
  });
</script>
{% endif %}

<div class="voucher">
  <div class="row">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-start">
        <div class="header-strong">Canada Revenue Agency</div>
        <div class="text-center">
          <div class="header-strong">CURRENT SOURCE DEDUCTIONS</div>
          <div class="header-strong">REMITTANCE VOUCHER</div>
        </div>
        <div class="small fw-semibold">PD7A E</div>
      </div>
    </div>
  </div>

  <div class="row mt-3 g-3">
    <div class="col-12 col-md-6"></div>
    <div class="col-12 col-md-6">
      <div class="box">
        <div class="box-title">Account number</div>
        <div class="account-line">
          <div class="acct">{{ remittance.bn_display }}</div>
          <div class="acct">RP0001</div>
        </div>
      </div>
    </div>
  </div>

  <div class="row mt-3 g-3">
    <div class="col-12 col-md-6">
      <div class="company-strong">{{ remittance.company_name }}</div>
      {% if remittance.company_address_lines %}
        {% for line in remittance.company_address_lines %}
          <div class="company-strong">{{ line }}</div>
        {% endfor %}
      {% else %}
        <div class="company-strong">{{ remittance.company_address }}</div>
      {% endif %}
    </div>
    <div class="col-12 col-md-6">
      <div class="row g-3">
        <div class="col-12">
          <div class="box">
            <div class="line">
              <div class="label">Gross Payroll</div>
              <div class="val">{{ remittance.total_gross | money }}</div>
            </div>
          </div>
        </div>
        <div class="col-12">
          <div class="row g-3">
            <div class="col-12 col-md-5">
              <div class="box">
                <div class="box-title">Employees in last pay period</div>
                <div class="value">{{ remittance.num_employees_last_pay_period }}</div>
              </div>
            </div>
            <div class="col-12 col-md-7">
              <div class="box">
                <div class="box-title">End of remitting period</div>
                <div class="d-flex justify-content-between">
                  <div><span class="small">Year</span> <span class="value">{{ remittance.date_to.year }}</span></div>
                  <div><span class="small">Month</span> <span class="value">{{ '%02d'|format(remittance.date_to.month) }}</span></div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-12">
          <div class="box">
            <div class="line">
              <div class="label">Amount paid</div>
              <div class="val">{{ remittance.total_remittance | money }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row mt-2">
    <div class="col-12">
      <div class="text-muted small">Period: {{ remittance.date_from }} to {{ remittance.date_to }}</div>
    </div>
  </div>
</div>
{% endblock %}
